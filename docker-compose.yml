version: "3"
services:
  service-report-api:
    image: node:16-slim
    user: "node"
    working_dir: /home/node/app
    volumes:
      - ./api:/home/node/app
    container_name: nodejs
    depends_on:
      - postgres
    ports:
      - "9090:9090"
    command: bash -c "npx nodemon listen.js"

  postgres:
    image: postgres:13.5
    ports:
      - "5432:5432"
    environment:
      - POSTGRES_USER=sruser
      - POSTGRES_PASSWORD=sruser
      - POSTGRES_DB=service_reports
    # volumes:
    #   - ./api/db_data:/var/lib/postgresql/data

  service-report-frontend:
    image: node:16-slim
    user: "node"
    working_dir: /home/node/app
    volumes:
      - ./frontend:/home/node/app
    container_name: frontend
    depends_on:
      - service-report-api
    ports:
      - "8080:8080"
    command: bash -c "npm run dev"
